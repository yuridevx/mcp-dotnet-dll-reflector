<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>McpNetDll - DLL Browser</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; }
    header { padding: 12px 16px; background: #0f172a; color: #fff; }
    main { display: grid; grid-template-columns: 320px 1fr; height: calc(100vh - 52px); }
    aside { border-right: 1px solid #e5e7eb; padding: 12px; overflow: auto; }
    section { padding: 12px; overflow: auto; }
    input, button { padding: 8px; font-size: 14px; }
    .ns { font-weight: 600; margin-top: 12px; }
    .type { margin-left: 12px; color: #334155; cursor: pointer; }
    pre { background: #0b1020; color: #e5e7eb; padding: 12px; border-radius: 8px; overflow: auto; }
    .row { display:flex; gap:8px; align-items:center; }
  </style>
  <script>
    async function loadNamespaces() {
      const res = await fetch('/api/namespaces');
      const json = await res.json();
      const list = document.getElementById('namespaces');
      list.innerHTML = '';
      (json.Namespaces || []).forEach(ns => {
        const nsEl = document.createElement('div');
        nsEl.className = 'ns';
        nsEl.textContent = ns.Name + ' (' + ns.TypeCount + ')';
        list.appendChild(nsEl);
        (ns.Types || []).forEach(t => {
          const tEl = document.createElement('div');
          tEl.className = 'type';
          tEl.textContent = t.Name + ' [' + t.TypeKind + ']';
          tEl.onclick = () => loadType(t.Namespace + '.' + t.Name);
          list.appendChild(tEl);
        });
      });
    }

    async function loadType(fullName) {
      const url = new URL('/api/types', location.origin);
      url.searchParams.append('typeNames', fullName);
      const res = await fetch(url);
      const json = await res.json();
      const out = document.getElementById('output');
      out.textContent = JSON.stringify(json, null, 2);
    }

    async function search() {
      const pattern = document.getElementById('q').value || '.*';
      const url = new URL('/api/search', location.origin);
      url.searchParams.set('pattern', pattern);
      const res = await fetch(url);
      const json = await res.json();
      const out = document.getElementById('output');
      out.textContent = JSON.stringify(json, null, 2);
    }

    window.addEventListener('DOMContentLoaded', loadNamespaces);
  </script>
</head>
<body>
  <header>
    <div class="row">
      <strong>McpNetDll</strong>
      <input id="q" placeholder="Regex search (e.g. Get.*)" style="flex:1;max-width:420px" />
      <button onclick="search()">Search</button>
    </div>
  </header>
  <main>
    <aside>
      <div id="namespaces"></div>
    </aside>
    <section>
      <pre id="output">Select a type or run a searchâ€¦</pre>
    </section>
  </main>
</body>
</html>


